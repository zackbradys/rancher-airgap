name: hauler-workflow
on: push

jobs:
  hauler-job-rocky-el9:
    name: Hauler Workflow Job for Rocky Linux 9.1
    runs-on: [self-hosted, linux, X64, rocky, el9]
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: View Repository Structure
        run: pwd && ls -la

      - name: Build Rancher Airgap Base
        run: |
          sh scripts/base/hauler-base.sh
          pwd
          ls -la
          mv /opt/rancher/hauler/base/rancher-airgap-rocky-el9.tar.zst /opt/actions-runner/_work/rancher-airgap/rancher-airgap/hauler/base/rancher-airgap-rocky-el9.tar.zst
          mv /opt/rancher/hauler/base/rancher-airgap-rocky-el9.yaml /opt/actions-runner/_work/rancher-airgap/rancher-airgap/hauler/base/rancher-airgap-rocky-el9.yaml
          pwd
          ls -la
          ls -la /opt/actions-runner/_work/rancher-airgap/rancher-airgap/hauler/base
          ls -la /opt/actions-runner/_work/rancher-airgap/rancher-airgap/scripts/base

  hauler-job-rhel-el9:
    name: Hauler Workflow Job for RHEL 9.1
    runs-on: [self-hosted, linux, X64, rhel, el9]
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: View Repository Structure
        run: pwd && ls -la

      - name: Build Rancher Airgap Base
        run: |
          sh scripts/base/hauler-base.sh
          pwd
          ls -la
          mv /opt/rancher/hauler/base/rancher-airgap-rocky-el9.tar.zst /opt/actions-runner/_work/rancher-airgap/rancher-airgap/hauler/base/rancher-airgap-rocky-el9.tar.zst
          mv /opt/rancher/hauler/base/rancher-airgap-rocky-el9.yaml /opt/actions-runner/_work/rancher-airgap/rancher-airgap/hauler/base/rancher-airgap-rocky-el9.yaml
          pwd
          ls -la
          ls -la /opt/actions-runner/_work/rancher-airgap/rancher-airgap/hauler/base
          ls -la /opt/actions-runner/_work/rancher-airgap/rancher-airgap/scripts/base